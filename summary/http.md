# 1、http 版本区别

- H T T P是一种简单无状态，纯文本的客户端服务器协议，他用于在客户端和服务器之间进行数据交换。
- 请求方法是请求行中的第一个单词，他指明了客户端想要对资源执行的操作。

​      http 0.9只有get方法

​      http 1.0添加了post和head方法

​      http 1.1则添加了put、delete、options、 trace、connect五个方法。

- 幂等的请求方法：一个http方法在使用相同的数据进行第二次调用的时候不会对服务器的状态造成任何改变，这个方法称为幂等。eg：put、delete。

# 2、https vs http

#### 一、http vs https

超文本传输协议HTTP协议被用于在Web浏览器和网站服务器之间传递信息，HTTP协议以明文方式发送内容，不提供任何方式的数据加密。

HTTP 有以下安全性问题：

- 使用明文进行通信，内容可能会**被窃听**；
- 不验证通信方的身份，通信方的身份有可能**遭遇伪装**；
- 无法证明报文的完整性，报文有可能**遭篡改**。



为了解决HTTP协议的这一缺陷，需要使用另一种协议：安全套接字层超文本传输协议HTTPS，为了数据传输的安全，HTTPS在HTTP的基础上加入了SSL协议，SSL依靠证书来验证服务器的身份，并为浏览器和服务器之间的通信加密。

HTTPS 并不是新协议，而是让 HTTP 先和 SSL（Secure Sockets Layer）通信，再由 SSL 和 TCP 通信，也就是说 HTTPS 使用了隧道进行通信。

通过使用 SSL，HTTPS 具有了**加密（防窃听）、认证（防伪装）和完整性保护（防篡改）**。		

#### **二、HTTP与HTTPS有什么区别？**

　　HTTP协议传输的数据都是未加密的、明文的，因此使用HTTP协议传输隐私信息非常不安全，为了保证这些隐私数据能加密传输，于是设计了SSL（Secure Sockets Layer）协议用于对HTTP协议传输的数据进行加密，从而就诞生了HTTPS。简单来说，HTTPS协议是由SSL+HTTP协议构建的可进行**加密传输、身份认证**的网络协议，要比http协议安全。

　　HTTPS和HTTP的区别主要如下：

　　1、https协议需要到ca申请证书，一般免费证书较少，因而需要一定费用。

　　2、http是超文本传输协议，信息是明文传输，https则是具有安全性的ssl加密传输协议。

　　3、http和https使用的是完全不同的连接方式，用的端口也不一样，前者是80，后者是443。

　　4、http的连接很简单，是无状态的；HTTPS协议是由SSL+HTTP协议构建的可进行加密传输、身份认证的网络协议，比http协议安全。



|          | http                                                         | https                                                        |
| -------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 概念     | 超文本传输协议                                               | 安全套接字层超文本传输协议HTTPS                              |
| 用途     | Web浏览器和网站服务器之间传递信息                            | 对网站服务器的身份认证；保护交换数据的隐私与完整性           |
| 公式     |                                                              | https=http+ssl                                               |
| 加密     | 未加密，不安全，铭文                                         | 加密，安全                                                   |
| 费用     |                                                              | 需要到ca申请证书，收费                                       |
| 端口     | 80                                                           | 443                                                          |
| 适用场景 |                                                              | 登陆、支付                                                   |
| 缺点     | 被窃听截取；完整性无法保证（易被篡改）；未验证（存在冒充危险） | HTTPS协议多次握手导致页面的加载时间延长；连接缓存不如HTTP高效，会增加数据开销和功耗； 申请SSL证书需要钱； SSL涉及到的安全算法会消耗 CPU 资源，对服务器资源消耗较大。 |
| 优点     | 开销少，访问快                                               | 保证完整性和隐私性，认证防篡改                               |

#### **三、HTTPS的工作原理**

![HTTP与HTTPS的区别-马海祥博客](http://www.mahaixiang.cn/uploads/allimg/1507/1-150H120343I41.jpg)

　客户端在使用HTTPS方式与Web服务器通信时有以下几个步骤，如图所示。

　　（1）客户使用https的URL访问Web服务器，要求与Web服务器建立SSL连接。

　　（2）Web服务器收到客户端请求后，会将**网站的证书信息（证书中包含公钥）传送一份给客户端**。

　　（3）客户端的浏览器与Web服务器开始协商SSL连接的安全等级，也就是信息加密的等级。

　　（4）客户端的浏览器根据双方同意的安全等级，建立**会话密钥**，然后利用网站的公钥将会话密钥加密，并传送给网站。

　　（5）Web服务器利用自己的**私钥解密**出**会话密钥**。

　　（6）Web服务器利用**会话密钥加密**与客户端之间的通信。

#### **四、HTTPS的优点**

　　主要有以下几个好处：

　　（1）使用HTTPS协议可认证用户和服务器，确保数据发送到正确的客户机和服务器；

　　（2）HTTPS协议是由SSL+HTTP协议构建的可进行加密传输、身份认证的网络协议，要比http协议安全，可防止数据在传输过程中不被窃取、改变，确保数据的完整性。

　　（3）HTTPS是现行架构下最安全的解决方案，虽然不是绝对安全，但它大幅增加了中间人攻击的成本。

#### **五、HTTPS的缺点**

　　虽然说HTTPS有很大的优势，但其相对来说，还是存在不足之处的：

　　（1）HTTPS协议握手阶段比较费时，会使页面的加载时间延长近50%，增加10%到20%的耗电；

　　（2）HTTPS连接缓存不如HTTP高效，会增加数据开销和功耗，甚至已有的安全措施也会因此而受到影响；

　　（3）SSL证书需要钱，功能越强大的证书费用越高，个人网站、小网站没有必要一般不会用。

　  （4）SSL证书通常需要绑定IP，不能在同一IP上绑定多个域名

#### 六、加密

##### 1. 对称密钥加密

对称密钥加密（Symmetric-Key Encryption），加密和解密使用同一密钥。

- 优点：运算速度快；
- 缺点：无法安全地将密钥传输给通信方。

##### 2.非对称密钥加密

非对称密钥加密，又称公开密钥加密（Public-Key Encryption），加密和解密使用不同的密钥。

非对称加密使用的是两个密钥，公钥与私钥，我们会使用公钥对网站账号密码等数据进行加密，再用私钥对数据进行解密。这个公钥会发给查看网站的所有人，而私钥是只有网站服务器自己拥有的。

公开密钥所有人都可以获得，通信发送方获得接收方的公开密钥之后，就可以使用公开密钥进行加密，接收方收到通信内容后使用私有密钥解密。

非对称密钥除了用来加密，还可以用来进行签名。因为私有密钥无法被其他人获取，因此通信发送方使用其私有密钥进行签名，通信接收方使用发送方的公开密钥对签名进行解密，就能判断这个签名是否正确。

- 优点：可以更安全地将公开密钥传输给通信发送方；
- 缺点：运算速度慢。

##### 3. HTTPS 采用的加密方式

上面提到对称密钥加密方式的传输效率更高，但是无法安全地将密钥 Secret Key 传输给通信方。而非对称密钥加密方式可以保证传输的安全性，因此我们可以利用非对称密钥加密方式将 Secret Key 传输给通信方。HTTPS 采用混合的加密机制，正是利用了上面提到的方案：

- 使用非对称密钥加密方式，传输对称密钥加密方式所需要的 Secret Key，从而保证安全性;
- 获取到 Secret Key 后，再使用对称密钥加密方式进行通信，从而保证效率。



　　

# 3、tcp三次握手四次挥手

#### **为什么需要三次握手？**

**为了防止已失效的连接请求报文段突然又传送到了服务端**，造成资源浪费

eg:client发出的第一个连接请求报文段并没有丢失，而是在某个网络结点长时间的滞留了，以致延误到连接释放以后的某个时间才到达server。本来这是一个早已失效的报文段。但server收到此失效的连接请求报文段后，就误认为是client再次发出的一个新的连接请求。于是就向client发出确认报文段，同意建立连接

假设不采用“三次握手”，那么只要server发出确认，新的连接就建立了。由于现在client并没有发出建立连接的请求，因此不会理睬server的确认，也不会向server发送数据。但server却以为新的运输连接已经建立，并一直等待client发来数据。这样，server的很多资源就白白浪费掉了。采用“三次握手”的办法可以防止上述现象发生。例如刚才那种情况，client不会向server的确认发出确认。server由于收不到确认，就知道client并没有要求建立连接。主要目的防止server端一直等待，浪费资源。

#### **为什么关闭连接需要四次挥手呢？**

关闭连接时，当收到对方的FIN报文时，仅仅表示对方不再发送数据了但是还能接收数据，己方也未必全部数据都发送给对方了，所以己方可以立即close，也可以发送一些数据给对方后，再发送FIN报文给对方来表示同意现在关闭连接



# 4、TCP,UDP通信使用场景及区别比较

TCP通信协议

- TCP是面向连接的；
- 每条TCP连接只能由于两个端点，一对一通信；
- TCP提供可靠的交付服务，传输数据无差错，不丢失，不重复，且按时序到达；
- TCP提供全双工通信；
- 面向字节流，TCP根据对方给出的窗口和当前的网络拥塞程度决定一个报文应该包含多少个字节。



UDP通信协议

- 无连接；
- UDP使用尽最大努力交付，不保证可靠性UDP;是面向报文的，UDP对应用层交付下来的报文，既不合并，也不拆分，而是保留报文的边界；
- 应用层交给UDP多长的报文，UDP就照样发送，即一次发送一个报文；
- UDP没有拥塞控制；
- UDP支持一对一，一对多，多对一和多对多的交互通信。
- UDP的首部开销小，只有8字节。

|            | TCP                                                          | UDP                               |
| ---------- | ------------------------------------------------------------ | --------------------------------- |
| 连接性     | 面向连接                                                     | 不需建立连接                      |
| 可靠性     | 可靠性的服务;无差错、不丢失、不重复、按顺序到达(校验和，重传控制，序号标识，滑动窗口、确认应答实现可靠传输) | 尽最大努力交付,不保证可靠性       |
| 工作效率   | 低                                                           | 高,适用高速传播和实时性较高的通信 |
| 连接方式   | 点到点                                                       | 一对一，一对多，多对一和多对多    |
| 对资源要求 | 多                                                           | 少                                |
| 适用场景   | 传输文件                                                     | 会议视频图像                      |



# 5、从输入url到页面加载完成发生了什么

​	   1、浏览器的地址栏输入URL并按下回车。

　　2、浏览器查找当前URL是否存在缓存，并比较缓存是否过期。

　　3、DNS解析URL对应的IP。

　　4、根据IP建立TCP连接（三次握手）。

![img](https://images2015.cnblogs.com/blog/1034346/201703/1034346-20170329145607592-1103856922.png)

　　5、HTTP Reques发起请求。　　

​        完整的HTTP请求包含请求起始行、请求头部、请求主体三部分。

　　6、服务器处理请求，浏览器接收HTTP Response响应。

```
   1xx：指示信息–表示请求已接收，继续处理。

　　2xx：成功–表示请求已被成功接收、理解、接受。

　　3xx：重定向–要完成请求必须进行更进一步的操作。

　　4xx：客户端错误–请求有语法错误或请求无法实现。

　　5xx：服务器端错误–服务器未能实现合法的请求。
```

　　7、渲染页面，构建DOM树。

　　8、关闭TCP连接（四次挥手）。



从网络协议层面来看:

![img](https://images2015.cnblogs.com/blog/1034346/201703/1034346-20170329153945389-2019926409.png)

1、应用层进行DNS解析

　　通过DNS将域名解析成IP地址。在解析过程中，按照`浏览器缓存`、`系统缓存`、`路由器缓存`、`ISP(运营商)DNS缓存`、`根域名服务器`、`顶级域名服务器`、`主域名服务器`的顺序，逐步读取缓存，直到拿到IP地址

2、应用层生成HTTP请求报文

　　接着，应用层生成针对目标WEB服务器的HTTP请求报文，HTTP请求报文包括起始行、首部和主体部分

3、传输层建立TCP连接

​        传输层传输协议分为UDP和TCP两种

　　UDP是无连接的协议，而TCP是可靠的有连接的协议，主要表现在：接收方会对收到的数据进行确认、发送方会重传接收方未确认的数据、接收方会将接收到数据按正确的顺序重新排序，并删除重复的数据、提供了控制拥挤的机制

　　HTTP协议使用的是TCP协议，为了方便通信

(1)HTTP请求报文按序号分为多个报文段**(segment)**，并对每个报文段进行封装。

(2)使用本地一个大于1024以上的随机TCP源端口建立到目的服务器TCP80号端口(HTTPS协议对应的端口号是443)的连接，**TCP源端口和目的端口**加入到报文段中，学名叫协议数据单元(Protocol Data Unit, PDU)。

(3)TCP是一个可靠的传输控制协议，传输层还会加入序列号、确认号、窗口大小、校验和等参数，共添加20字节的头部信息

![http](https://pic.xiaohuochai.site/blog/HTTP_network15.jpg)

构建TCP请求会增加大量的网络时延，常用的优化方式如下所示

　　（1）资源打包，合并请求

　　（2）多使用缓存，减少网络传输

　　（3）使用keep-alive建立持久连接

　　4、网络层使用IP协议来选择路线

​			处理上层传输层的数据段segment，将数据段segment装入数据包**packet**，主要就是添加**源和目的IP地址**，然后发送数据。在数据传输的过程中，IP协议负责选择传送的路线，称为路由功能

![http](https://pic.xiaohuochai.site/blog/HTTP_network12.jpg)

5、数据链路层实现网络相邻结点间可靠的数据通信

　　为了保证数据的可靠传输，把数据包packet封装成帧(**Frame**)，并按顺序传送各帧。由于物理线路的不可靠，发出的数据帧有可能在线路上出错或丢失，于是为每个数据分块计算出CRC(循环冗余检验)，并把CRC添加到帧中，这样接收方就可以通过重新计算CRC来判断数据接收的正确性。一旦出错就重传

　　将数据包packet封装成帧(**Frame**)，包括帧头和帧尾。帧尾是添加被称做CRC的循环冗余校验部分。帧头主要是添加数据链路层的地址，即数据链路层的源地址和目的地址，即**网络相邻结点间的源MAC地址和目的MAC地址**

　　6、物理层传输数据

　　数据链路层的帧(Frame)转换成二进制形式的比特(Bit)流，从网卡发送出去，再把比特转换成电子、光学或微波信号在网络中传输

上面的6个步骤可总结为：DNS解析URL地址、生成HTTP请求报文、构建TCP连接、使用IP协议选择传输路线、数据链路层保证数据的可靠传输、物理层将数据转换成电子、光学或微波信号进行传输



# 6、状态码



## HTTP状态码分类

| 分类 | 分类描述                                       |
| :--- | :--------------------------------------------- |
| 1**  | 信息，服务器收到请求，需要请求者继续执行操作   |
| 2**  | 成功，操作被成功接收并处理                     |
| 3**  | 重定向，需要进一步的操作以完成请求             |
| 4**  | 客户端错误，请求包含语法错误或无法完成请求     |
| 5**  | 服务器错误，服务器在处理请求的过程中发生了错误 |



HTTP状态码列表:

| 状态码 | 状态码英文名称        | 中文描述                                                     |
| :----- | :-------------------- | :----------------------------------------------------------- |
| 200    | OK                    | 请求成功。一般用于GET与POST请求                              |
|        |                       |                                                              |
| 301    | Moved Permanently     | 永久移动。请求的资源已被永久的移动到新URI，返回信息会包括新的URI，浏览器会自动定向到新URI。今后任何新的请求都应使用新的URI代替 |
| 302    | Found                 | 临时移动。与301类似。但资源只是临时被移动。客户端应继续使用原有URI |
| 303    | See Other             | 查看其它地址。与301类似。使用GET和POST请求查看               |
| 304    | Not Modified          | 未修改。所请求的资源未修改，服务器返回此状态码时，不会返回任何资源。客户端通常会缓存访问过的资源，通过提供一个头信息指出客户端希望只返回在指定日期之后修改的资源 |
| 307    | Temporary Redirect    | 临时重定向。与302类似。使用GET请求重定向                     |
|        |                       |                                                              |
| 400    | Bad Request           | 客户端请求的语法错误，服务器无法理解                         |
| 401    | Unauthorized          | 请求要求用户的身份认证                                       |
| 403    | Forbidden             | 服务器理解请求客户端的请求，但是拒绝执行此请求               |
| 404    | Not Found             | 服务器无法根据客户端的请求找到资源（网页）                   |
| 405    | Method Not Allowed    | 客户端请求中的方法被禁止                                     |
|        |                       |                                                              |
| 500    | Internal Server Error | 服务器内部错误，无法完成请求                                 |
| 501    | Not Implemented       | 服务器不支持请求的功能，无法完成请求                         |
| 502    | Bad Gateway           | 作为网关或者代理工作的服务器尝试执行请求时，从远程服务器接收到了一个无效的响应 |
| 504    | Gateway Time-out      | 充当网关或代理的服务器，未及时从远端服务器获取请求           |